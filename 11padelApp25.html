<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>11PadelCrew - Sistema de Torneos</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        :root {
            --padel-court: #1e8449;
            --padel-blue: #2980b9;
            --padel-pink: #e84393;
            --padel-green: #27ae60;
            --padel-orange: #e67e22;
            --padel-purple: #8e44ad;
            --padel-light: #f8f9fa;
            --padel-dark: #2c3e50;
            --padel-gray: #7f8c8d;
            --padel-light-gray: #ecf0f1;
            --padel-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
        }
        
        body {
            background: linear-gradient(135deg, #d1e8d5 0%, #c3e3c9 100%);
            min-height: 100vh;
            padding: 20px;
            color: var(--padel-dark);
            background-image: 
                radial-gradient(circle at 10% 20%, rgba(39, 174, 96, 0.1) 0%, transparent 20%),
                radial-gradient(circle at 90% 80%, rgba(41, 128, 185, 0.1) 0%, transparent 20%);
            background-attachment: fixed;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        
        header {
            text-align: center;
            margin-bottom: 30px;
            padding: 20px;
            position: relative;
            background: linear-gradient(90deg, var(--padel-blue) 0%, var(--padel-green) 100%);
            border-radius: 15px;
            box-shadow: var(--padel-shadow);
            border: 3px solid white;
        }
        
        .logo {
            font-size: 2.8rem;
            font-weight: 800;
            color: white;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
            margin-bottom: 5px;
            letter-spacing: 1px;
        }
        
        .subtitle {
            color: rgba(255, 255, 255, 0.9);
            font-size: 0.9rem;
            font-weight: 500;
            position: absolute;
            bottom: 10px;
            right: 20px;
        }
        
        .card {
            background: white;
            border-radius: 15px;
            box-shadow: var(--padel-shadow);
            overflow: hidden;
            margin-bottom: 25px;
            transition: transform 0.3s ease;
            border: 2px solid rgba(0, 0, 0, 0.05);
        }
        
        .card:hover {
            transform: translateY(-5px);
        }
        
        .card-header {
            background: linear-gradient(90deg, var(--padel-blue) 0%, var(--padel-green) 100%);
            color: white;
            padding: 15px 20px;
            font-size: 1.3rem;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .card-body {
            padding: 25px;
        }
        
        .btn-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-top: 10px;
        }
        
        .btn {
            padding: 18px 15px;
            border: none;
            border-radius: 12px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            transition: all 0.3s ease;
            text-align: center;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }
        
        .btn-primary {
            background: linear-gradient(135deg, var(--padel-blue) 0%, var(--padel-purple) 100%);
            color: white;
        }
        
        .btn-primary:hover {
            background: linear-gradient(135deg, #1a4f8c 0%, #7d3c98 100%);
            transform: translateY(-3px);
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.25);
        }
        
        .btn-secondary {
            background: linear-gradient(135deg, var(--padel-pink) 0%, var(--padel-orange) 100%);
            color: white;
        }
        
        .btn-secondary:hover {
            background: linear-gradient(135deg, #d32f7d 0%, #d35400 100%);
            transform: translateY(-3px);
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.25);
        }
        
        .btn-sm {
            padding: 10px 20px;
            font-size: 0.9rem;
            border-radius: 10px;
        }
        
        .tabs {
            display: flex;
            background: var(--padel-light-gray);
            border-radius: 10px;
            overflow: hidden;
            margin-bottom: 20px;
            box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.08);
        }
        
        .tab {
            flex: 1;
            padding: 15px;
            text-align: center;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
            position: relative;
        }
        
        .tab.active {
            background: linear-gradient(135deg, var(--padel-blue) 0%, var(--padel-green) 100%);
            color: white;
        }
        
        .tab:not(.active):hover {
            background: rgba(41, 128, 185, 0.1);
        }
        
        .tab-content {
            display: none;
            animation: fadeIn 0.4s ease;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .tab-content.active {
            display: block;
        }
        
        .players-container {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }
        
        .player-card {
            background: var(--padel-light);
            border-radius: 10px;
            padding: 15px;
            text-align: center;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            border: 2px solid transparent;
            transition: all 0.3s ease;
            background: linear-gradient(135deg, #f8f9fa 0%, #e9f7ef 100%);
            position: relative;
            overflow: hidden;
        }
        
        .player-card::after {
            content: "";
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, var(--padel-blue), var(--padel-green));
        }
        
        .player-card h3 {
            font-size: 1.1rem;
            margin-bottom: 5px;
            color: var(--padel-dark);
        }
        
        .player-card p {
            font-size: 0.9rem;
            color: var(--padel-gray);
        }
        
        .match-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
            gap: 25px;
            margin-bottom: 20px;
        }
        
        .match-card {
            background: white;
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            border-left: 5px solid var(--padel-green);
            background: linear-gradient(135deg, #ffffff 0%, #f9fbfa 100%);
            position: relative;
            overflow: hidden;
            border: 1px solid rgba(0, 0, 0, 0.1);
        }
        
        .match-card::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, var(--padel-blue), var(--padel-pink));
        }
        
        .match-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 1px solid var(--padel-light-gray);
        }
        
        .match-title {
            font-weight: 700;
            color: var(--padel-blue);
            font-size: 1.1rem;
        }
        
        .match-court {
            background: var(--padel-orange);
            color: white;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 600;
        }
        
        .teams-container {
            display: grid;
            grid-template-columns: 1fr auto 1fr;
            gap: 15px;
            align-items: center;
        }
        
        .team {
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 15px;
            border-radius: 10px;
            background: linear-gradient(135deg, #e3f2fd 0%, #f0f9ff 100%);
            border: 1px solid rgba(0, 0, 0, 0.05);
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
        }
        
        .team-name {
            font-weight: 700;
            margin-bottom: 10px;
            text-align: center;
            color: var(--padel-blue);
        }
        
        .team-players {
            text-align: center;
            font-size: 0.9rem;
            color: var(--padel-gray);
            margin-bottom: 10px;
            min-height: 20px;
        }
        
        .vs {
            font-weight: 900;
            color: var(--padel-pink);
            font-size: 1.4rem;
            text-shadow: 0 2px 2px rgba(0, 0, 0, 0.1);
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .score-container {
            display: flex;
            align-items: center;
            gap: 8px;
            justify-content: center;
            margin-top: 10px;
        }
        
        .score-input {
            width: 65px;
            padding: 12px;
            text-align: center;
            font-size: 1.3rem;
            font-weight: 700;
            border: 2px solid var(--padel-light-gray);
            border-radius: 10px;
            outline: none;
            background: white;
            box-shadow: inset 0 2px 6px rgba(0, 0, 0, 0.08);
            transition: all 0.3s ease;
        }
        
        .score-input:focus {
            border-color: var(--padel-green);
            box-shadow: 0 0 0 3px rgba(39, 174, 96, 0.3);
        }
        
        .score-btn {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            background: var(--padel-light-gray);
            border: none;
            font-size: 1.5rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.2s ease;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }
        
        .score-btn:hover {
            background: var(--padel-green);
            color: white;
        }
        
        .standings-container {
            overflow-x: auto;
            border-radius: 10px;
            box-shadow: var(--padel-shadow);
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            background: white;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: var(--padel-shadow);
        }
        
        th {
            background: linear-gradient(135deg, var(--padel-blue) 0%, var(--padel-green) 100%);
            color: white;
            padding: 16px 12px;
            text-align: center;
            font-weight: 700;
            position: sticky;
            top: 0;
        }
        
        td {
            padding: 14px 12px;
            text-align: center;
            border-bottom: 1px solid var(--padel-light-gray);
            font-weight: 500;
        }
        
        tr:nth-child(even) {
            background: rgba(232, 67, 147, 0.03);
        }
        
        tr:hover {
            background: rgba(41, 128, 185, 0.05);
        }
        
        .pos-1 {
            background: rgba(255, 215, 0, 0.15) !important;
            font-weight: 700;
        }
        
        .pos-2 {
            background: rgba(192, 192, 192, 0.1) !important;
        }
        
        .pos-3 {
            background: rgba(205, 127, 50, 0.1) !important;
        }
        
        .filters {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }
        
        .filter-btn {
            padding: 10px 18px;
            background: white;
            border: 1px solid var(--padel-light-gray);
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 600;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.08);
        }
        
        .filter-btn.active {
            background: linear-gradient(135deg, var(--padel-blue) 0%, var(--padel-green) 100%);
            color: white;
            border-color: var(--padel-blue);
        }
        
        .filter-btn:not(.active):hover {
            background: rgba(41, 128, 185, 0.1);
        }
        
        .actions {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-top: 20px;
            flex-wrap: wrap;
            display: none;
        }
        
        .btn-accent {
            background: linear-gradient(135deg, var(--padel-pink) 0%, var(--padel-orange) 100%);
            color: white;
        }
        
        .btn-accent:hover {
            background: linear-gradient(135deg, #d32f7d 0%, #d35400 100%);
        }
        
        .hidden {
            display: none;
        }
        
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.7);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s ease;
        }
        
        .modal.active {
            opacity: 1;
            pointer-events: all;
        }
        
        .modal-content {
            background: white;
            border-radius: 15px;
            width: 90%;
            max-width: 500px;
            box-shadow: 0 15px 40px rgba(0, 0, 0, 0.3);
            transform: translateY(20px);
            transition: transform 0.3s ease;
            max-height: 90vh;
            overflow-y: auto;
        }
        
        .modal.active .modal-content {
            transform: translateY(0);
        }
        
        .modal-header {
            background: linear-gradient(90deg, var(--padel-blue) 0%, var(--padel-green) 100%);
            color: white;
            padding: 20px;
            border-radius: 15px 15px 0 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: sticky;
            top: 0;
            z-index: 10;
        }
        
        .modal-body {
            padding: 25px;
            max-height: 60vh;
            overflow-y: auto;
        }
        
        .modal-footer {
            padding: 15px 25px;
            background: var(--padel-light-gray);
            display: flex;
            justify-content: flex-end;
            gap: 10px;
            border-radius: 0 0 15px 15px;
            position: sticky;
            bottom: 0;
        }
        
        .input-group {
            margin-bottom: 20px;
        }
        
        .input-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--padel-dark);
        }
        
        .input-group input, 
        .input-group select {
            width: 100%;
            padding: 14px 18px;
            border: 2px solid var(--padel-light-gray);
            border-radius: 12px;
            font-size: 1rem;
            transition: border-color 0.3s ease;
            background: white;
            box-shadow: inset 0 2px 6px rgba(0, 0, 0, 0.08);
        }
        
        .input-group input:focus, 
        .input-group select:focus {
            border-color: var(--padel-green);
            outline: none;
            box-shadow: 0 0 0 3px rgba(39, 174, 96, 0.3);
        }
        
        .player-inputs {
            display: grid;
            grid-template-columns: 1fr;
            gap: 15px;
            margin-top: 15px;
            max-height: 400px;
            overflow-y: auto;
            padding: 10px;
        }
        
        .player-input {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .player-input i {
            color: var(--padel-pink);
            font-size: 1.2rem;
        }
        
        .player-input input {
            flex: 1;
            padding: 12px 16px;
            border: 2px solid var(--padel-light-gray);
            border-radius: 10px;
            font-size: 1rem;
            box-shadow: inset 0 2px 5px rgba(0, 0, 0, 0.08);
        }
        
        .round-nav {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-bottom: 25px;
            flex-wrap: wrap;
        }
        
        .round-btn {
            min-width: 45px;
            height: 45px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            background: var(--padel-light-gray);
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 3px 6px rgba(0, 0, 0, 0.1);
            border: 2px solid transparent;
        }
        
        .round-btn.active {
            background: linear-gradient(135deg, var(--padel-blue) 0%, var(--padel-green) 100%);
            color: white;
            transform: scale(1.1);
            border-color: white;
        }
        
        .round-btn:hover:not(.active) {
            background: rgba(41, 128, 185, 0.15);
        }
        
        .padel-ball {
            position: absolute;
            width: 25px;
            height: 25px;
            background: linear-gradient(135deg, var(--padel-green) 0%, var(--padel-blue) 100%);
            border-radius: 50%;
            box-shadow: 0 2px 6px rgba(0, 0, 0, 0.3);
            z-index: -1;
        }
        
        .padel-court-bg {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: 
                linear-gradient(transparent 24%, var(--padel-green) 24%, var(--padel-green) 26%, transparent 26%),
                linear-gradient(90deg, transparent 24%, var(--padel-green) 24%, var(--padel-green) 26%, transparent 26%),
                linear-gradient(45deg, transparent 24%, var(--padel-green) 24%, var(--padel-green) 26%, transparent 26%),
                linear-gradient(-45deg, transparent 24%, var(--padel-green) 24%, var(--padel-green) 26%, transparent 26%);
            background-size: 100px 100px;
            background-position: center;
            opacity: 0.05;
            pointer-events: none;
            z-index: -1;
        }
        
        .winner-badge {
            position: absolute;
            top: 10px;
            right: 10px;
            background: var(--padel-orange);
            color: white;
            padding: 3px 8px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
            display: none;
        }
        
        .match-card.winner-1 .winner-badge.team1,
        .match-card.winner-2 .winner-badge.team2 {
            display: block;
        }
        
        .resting-player {
            background: linear-gradient(135deg, #f1f2f6 0%, #dfe4ea 100%);
            border-radius: 10px;
            padding: 15px;
            text-align: center;
            margin-top: 20px;
            box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1);
            border: 2px dashed var(--padel-gray);
        }
        
        .resting-player h3 {
            color: var(--padel-gray);
            margin-bottom: 5px;
        }
        
        .resting-player p {
            font-weight: 700;
            font-size: 1.2rem;
            color: var(--padel-blue);
        }
        
        .stats-highlight {
            background: rgba(39, 174, 96, 0.1);
            border-radius: 8px;
            padding: 3px 8px;
            font-weight: 700;
        }
        
        .cycle-info {
            background: rgba(231, 76, 60, 0.1);
            padding: 10px;
            border-radius: 10px;
            text-align: center;
            margin-bottom: 15px;
            font-weight: 600;
            color: var(--padel-orange);
        }
        
        .rest-info {
            margin-top: 15px;
            padding: 15px;
            background: rgba(236, 240, 241, 0.7);
            border-radius: 10px;
            border: 1px dashed var(--padel-gray);
        }
        
        .rest-list {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            justify-content: center;
            margin-top: 10px;
        }
        
        .rest-player {
            background: var(--padel-light);
            padding: 8px 15px;
            border-radius: 20px;
            font-weight: 600;
            color: var(--padel-dark);
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .saved-tournament {
            background: linear-gradient(135deg, #e3f2fd 0%, #bbdefb 100%);
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 15px;
            border: 2px solid var(--padel-blue);
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .saved-tournament:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }
        
        .saved-tournament h3 {
            color: var(--padel-blue);
            margin-bottom: 5px;
        }
        
        .saved-tournament p {
            color: var(--padel-dark);
            margin-bottom: 3px;
        }
        
        .delete-btn {
            background: #e74c3c;
            color: white;
            border: none;
            padding: 5px 10px;
            border-radius: 5px;
            cursor: pointer;
            margin-top: 10px;
        }
        
        .tournament-actions {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-top: 20px;
            flex-wrap: wrap;
        }
        
        @media (max-width: 768px) {
            .btn-container {
                grid-template-columns: 1fr;
            }
            
            .teams-container {
                grid-template-columns: 1fr;
                grid-template-rows: 1fr auto 1fr;
            }
            
            .vs {
                margin: 15px 0;
            }
            
            .players-container {
                grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            }
            
            .card-body {
                padding: 15px;
            }
            
            .tournament-actions {
                flex-direction: column;
                gap: 10px;
            }
            
            .btn {
                width: 100%;
            }
            
            .match-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="padel-court-bg"></div>
    <div class="container">
        <!-- Pantalla principal -->
        <div id="main-screen">
            <header>
                <div class="logo">11PadelCrew</div>
                <div class="subtitle">By Edy Padilla</div>
            </header>
            
            <div class="card">
                <div class="card-header">
                    <i class="fas fa-trophy"></i>
                    TORNEO ESTILO AMERICANO
                </div>
                <div class="card-body">
                    <h2 style="text-align: center; margin-bottom: 25px; color: var(--padel-blue);">Seleccione una opción</h2>
                    
                    <div class="btn-container">
                        <button class="btn btn-primary" onclick="showIndividualModal()">
                            <i class="fas fa-user"></i> Nuevo Torneo Individual
                        </button>
                        <button class="btn btn-secondary" onclick="showTeamModal()">
                            <i class="fas fa-users"></i> Nuevo Torneo por Equipos
                        </button>
                    </div>
                </div>
            </div>
            
            <div class="card">
                <div class="card-header">
                    <i class="fas fa-history"></i>
                    TORNEOS GUARDADOS
                </div>
                <div class="card-body" id="saved-tournaments-container">
                    <p style="text-align: center; color: var(--padel-gray); padding: 20px;">
                        <i class="fas fa-inbox" style="font-size: 3rem; margin-bottom: 15px; opacity: 0.3;"></i><br>
                        No hay torneos guardados
                    </p>
                </div>
            </div>
        </div>
        
        <!-- Pantalla de nombres de jugadores -->
        <div id="players-screen" class="hidden">
            <header>
                <div class="logo">11PadelCrew</div>
                <div class="subtitle">By Edy Padilla</div>
            </header>
            
            <div class="card">
                <div class="card-header">
                    <i class="fas fa-users"></i>
                    <span id="players-title">INGRESE NOMBRES DE JUGADORES</span>
                </div>
                <div class="card-body">
                    <div class="player-inputs" id="players-input-container">
                        <!-- Los inputs se generarán dinámicamente aquí -->
                    </div>
                    
                    <div class="tournament-actions">
                        <button class="btn btn-sm" onclick="goBackToMain()">
                            <i class="fas fa-arrow-left"></i> Volver
                        </button>
                        <button class="btn btn-sm btn-primary" onclick="startTournament()">
                            <i class="fas fa-play"></i> Comenzar Torneo
                        </button>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Pantalla de torneo -->
        <div id="tournament-screen" class="hidden">
            <header>
                <div class="logo">11PadelCrew</div>
                <div class="subtitle">By Edy Padilla</div>
            </header>
            
            <div class="card">
                <div class="card-header">
                    <i class="fas fa-trophy"></i>
                    <span id="tournament-title">TORNEO 6 JUGADORES</span>
                </div>
                <div class="card-body">
                    <div class="tabs">
                        <div class="tab active" data-tab="matches">Partidos</div>
                        <div class="tab" data-tab="standings">Clasificación</div>
                        <div class="tab" data-tab="players">Jugadores</div>
                    </div>
                    
                    <!-- Pestaña de partidos -->
                    <div class="tab-content active" id="matches-content">
                        <div class="round-nav" id="round-nav">
                            <!-- Los botones de ronda se generarán dinámicamente aquí -->
                        </div>
                        
                        <div class="cycle-info" id="cycle-info">
                            Jornada 1 de 2
                        </div>
                        
                        <h3 style="text-align: center; margin-bottom: 20px; color: var(--padel-blue);" id="round-title">Ronda 1</h3>
                        
                        <div class="match-grid" id="matches-container">
                            <!-- Los partidos se generarán dinámicamente aquí -->
                        </div>
                        
                        <!-- Jugadores que descansan -->
                        <div id="rest-container" class="rest-info">
                            <h3 style="text-align: center; color: var(--padel-gray);">Jugadores que descansan esta ronda:</h3>
                            <div class="rest-list" id="resting-players-container">
                                <!-- Jugadores en descanso se mostrarán aquí -->
                            </div>
                        </div>
                    </div>
                    
                    <!-- Pestaña de clasificación -->
                    <div class="tab-content" id="standings-content">
                        <div class="filters">
                            <div class="filter-btn active" data-sort="points">Por puntos</div>
                            <div class="filter-btn" data-sort="diff">Por diferencia</div>
                            <div class="filter-btn" data-sort="pg">Por victorias</div>
                        </div>
                        
                        <div class="standings-container">
                            <table id="standings-table">
                                <thead>
                                    <tr>
                                        <th>Pos</th>
                                        <th>Nombre</th>
                                        <th>PJ</th>
                                        <th>PG</th>
                                        <th>PE</th>
                                        <th>PP</th>
                                        <th>PF</th>
                                        <th>PC</th>
                                        <th>Dif</th>
                                        <th>Pts</th>
                                    </tr>
                                </thead>
                                <tbody id="standings-body">
                                    <!-- Los datos de clasificación se generarán dinámicamente aquí -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                    
                    <!-- Pestaña de jugadores -->
                    <div class="tab-content" id="players-content">
                        <div class="players-container" id="players-container">
                            <!-- Las tarjetas de jugadores se generarán dinámicamente aquí -->
                        </div>
                    </div>
                    
                    <div class="tournament-actions">
                        <button class="btn btn-sm btn-primary" onclick="saveTournament()">
                            <i class="fas fa-save"></i> Guardar Cambios
                        </button>
                        <button class="btn btn-sm btn-accent" id="next-round-btn" onclick="nextRound()">
                            <i class="fas fa-forward"></i> Siguiente Ronda
                        </button>
                        <button class="btn btn-sm btn-accent" id="finish-tournament-btn" onclick="finishTournament()">
                            <i class="fas fa-flag-checkered"></i> Finalizar Jornada
                        </button>
                        <button class="btn btn-sm btn-primary" id="continue-tournament-btn" onclick="continueTournament()">
                            <i class="fas fa-plus-circle"></i> Continuar Nueva Jornada
                        </button>
                        <button class="btn btn-sm" onclick="goBackToMainFromTournament()">
                            <i class="fas fa-home"></i> Volver al Inicio
                        </button>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Modal Individual -->
        <div class="modal" id="individual-modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3><i class="fas fa-user"></i> Torneo Individual</h3>
                    <i class="fas fa-times close-modal" onclick="closeModal('individual-modal')"></i>
                </div>
                <div class="modal-body">
                    <div class="input-group">
                        <label>Número de jugadores</label>
                        <select id="player-count">
                            <option value="4">4 jugadores</option>
                            <option value="5">5 jugadores</option>
                            <option value="6" selected>6 jugadores</option>
                            <option value="7">7 jugadores</option>
                            <option value="8">8 jugadores</option>
                            <option value="9">9 jugadores</option>
                            <option value="10">10 jugadores</option>
                        </select>
                    </div>
                    
                    <div class="input-group">
                        <label>Nombre del torneo (opcional)</label>
                        <input type="text" id="tournament-name" placeholder="Ej: Torneo Verano 2023">
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-sm" onclick="closeModal('individual-modal')">Cancelar</button>
                    <button class="btn btn-sm btn-primary" onclick="confirmIndividualTournament()">Continuar</button>
                </div>
            </div>
        </div>
        
        <!-- Modal Equipos -->
        <div class="modal" id="team-modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3><i class="fas fa-users"></i> Torneo por Equipos</h3>
                    <i class="fas fa-times close-modal" onclick="closeModal('team-modal')"></i>
                </div>
                <div class="modal-body">
                    <div class="input-group">
                        <label>Número de equipos (parejas)</label>
                        <select id="team-count">
                            <option value="2">2 equipos</option>
                            <option value="3">3 equipos</option>
                            <option value="4">4 equipos</option>
                            <option value="5">5 equipos</option>
                            <option value="6" selected>6 equipos</option>
                            <option value="7">7 equipos</option>
                            <option value="8">8 equipos</option>
                            <option value="9">9 equipos</option>
                            <option value="10">10 equipos</option>
                        </select>
                    </div>
                    
                    <div class="input-group">
                        <label>Nombre del torneo (opcional)</label>
                        <input type="text" id="team-tournament-name" placeholder="Ej: Liga Empresa 2023">
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-sm" onclick="closeModal('team-modal')">Cancelar</button>
                    <button class="btn btn-sm btn-secondary" onclick="confirmTeamTournament()">Continuar</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Datos del torneo
        let tournamentData = {
            mode: null,
            title: '',
            players: [],
            teams: [],
            currentRound: 1,
            totalRounds: 0,
            rounds: [],
            currentCycle: 1,
            totalCycles: 2,
            id: null,
            matchCounter: 0 // Contador global para IDs únicos de partidos
        };

        // Al cargar la página, cargar torneos guardados
        document.addEventListener('DOMContentLoaded', function() {
            loadSavedTournaments();
            
            // Manejo de pestañas
            document.querySelectorAll('.tab').forEach(tab => {
                tab.addEventListener('click', () => {
                    document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
                    tab.classList.add('active');
                    
                    document.querySelectorAll('.tab-content').forEach(content => {
                        content.classList.remove('active');
                    });
                    
                    const tabId = tab.getAttribute('data-tab');
                    document.getElementById(`${tabId}-content`).classList.add('active');
                    
                    if (tabId === 'standings') updateStandingsTable();
                    if (tabId === 'players') updatePlayersTab();
                });
            });

            // Manejo de filtros
            document.querySelectorAll('.filter-btn').forEach(btn => {
                btn.addEventListener('click', () => {
                    document.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));
                    btn.classList.add('active');
                    updateStandingsTable();
                });
            });
        });

        // Funciones para localStorage
        function saveTournamentToStorage() {
            if (!tournamentData.id) {
                tournamentData.id = 'tournament_' + new Date().getTime();
            }
            localStorage.setItem(tournamentData.id, JSON.stringify(tournamentData));
            loadSavedTournaments();
        }

        function loadTournamentFromStorage(id) {
            const data = localStorage.getItem(id);
            if (data) {
                return JSON.parse(data);
            }
            return null;
        }

        function loadSavedTournaments() {
            const container = document.getElementById('saved-tournaments-container');
            container.innerHTML = '';
            
            let hasSavedTournaments = false;
            
            for (let i = 0; i < localStorage.length; i++) {
                const key = localStorage.key(i);
                if (key.startsWith('tournament_')) {
                    hasSavedTournaments = true;
                    const tournament = JSON.parse(localStorage.getItem(key));
                    
                    const tournamentElement = document.createElement('div');
                    tournamentElement.className = 'saved-tournament';
                    tournamentElement.innerHTML = `
                        <h3>${tournament.title}</h3>
                        <p><strong>Modo:</strong> ${tournament.mode === 'individual' ? 'Individual' : 'Por Equipos'}</p>
                        <p><strong>Jugadores/Equipos:</strong> ${tournament.mode === 'individual' ? tournament.players.length : tournament.teams.length}</p>
                        <p><strong>Progreso:</strong> Ronda ${tournament.currentRound} de ${tournament.totalRounds}</p>
                        <button class="delete-btn" onclick="deleteTournament('${key}', event)"><i class="fas fa-trash"></i> Eliminar</button>
                    `;
                    
                    tournamentElement.addEventListener('click', function(e) {
                        if (!e.target.classList.contains('delete-btn')) {
                            continueSavedTournament(key);
                        }
                    });
                    
                    container.appendChild(tournamentElement);
                }
            }
            
            if (!hasSavedTournaments) {
                container.innerHTML = `
                    <p style="text-align: center; color: var(--padel-gray); padding: 20px;">
                        <i class="fas fa-inbox" style="font-size: 3rem; margin-bottom: 15px; opacity: 0.3;"></i><br>
                        No hay torneos guardados
                    </p>
                `;
            }
        }

        function continueSavedTournament(id) {
            const savedData = loadTournamentFromStorage(id);
            if (savedData) {
                tournamentData = savedData;
                // Asegurar que matchCounter esté inicializado
                if (!tournamentData.matchCounter) {
                    tournamentData.matchCounter = 0;
                    // Actualizar IDs de partidos si es necesario
                    tournamentData.rounds.forEach(round => {
                        round.matches.forEach(match => {
                            tournamentData.matchCounter = Math.max(tournamentData.matchCounter, parseInt(match.id.replace('match-', '')) || 0);
                        });
                    });
                }
                document.getElementById('tournament-title').textContent = tournamentData.title;
                document.getElementById('main-screen').classList.add('hidden');
                document.getElementById('tournament-screen').classList.remove('hidden');
                showRound(tournamentData.currentRound);
                updateStandings();
                updatePlayersTab();
                updateCycleInfo();
            }
        }

        function deleteTournament(id, event) {
            event.stopPropagation();
            if (confirm('¿Estás seguro de que deseas eliminar este torneo?')) {
                localStorage.removeItem(id);
                loadSavedTournaments();
            }
        }

        // Funciones para mostrar/ocultar modales
        function showIndividualModal() {
            document.getElementById('individual-modal').classList.add('active');
        }
        
        function showTeamModal() {
            document.getElementById('team-modal').classList.add('active');
        }
        
        function closeModal(modalId) {
            document.getElementById(modalId).classList.remove('active');
        }
        
        // Confirmar torneo individual
        function confirmIndividualTournament() {
            const playerCount = parseInt(document.getElementById('player-count').value);
            const tournamentName = document.getElementById('tournament-name').value;
            
            tournamentData.mode = 'individual';
            tournamentData.title = tournamentName || `Torneo Individual - ${playerCount} Jugadores`;
            
            // Generar inputs para nombres de jugadores
            const container = document.getElementById('players-input-container');
            container.innerHTML = '';
            
            for (let i = 1; i <= playerCount; i++) {
                const playerDiv = document.createElement('div');
                playerDiv.className = 'player-input';
                playerDiv.innerHTML = `
                    <i class="fas fa-user"></i>
                    <input type="text" class="player-name" placeholder="Jugador ${i}" required>
                `;
                container.appendChild(playerDiv);
            }
            
            // Actualizar título
            document.getElementById('players-title').textContent = `INGRESE NOMBRES DE ${playerCount} JUGADORES`;
            
            closeModal('individual-modal');
            document.getElementById('main-screen').classList.add('hidden');
            document.getElementById('players-screen').classList.remove('hidden');
        }
        
        // Confirmar torneo por equipos
        function confirmTeamTournament() {
            const teamCount = parseInt(document.getElementById('team-count').value);
            const tournamentName = document.getElementById('team-tournament-name').value;
            
            tournamentData.mode = 'teams';
            tournamentData.title = tournamentName || `Torneo por Equipos - ${teamCount} Equipos`;
            
            // Generar inputs para nombres de equipos
            const container = document.getElementById('players-input-container');
            container.innerHTML = '';
            
            for (let i = 1; i <= teamCount; i++) {
                const teamDiv = document.createElement('div');
                teamDiv.className = 'player-input';
                teamDiv.innerHTML = `
                    <i class="fas fa-users"></i>
                    <input type="text" class="player-name" placeholder="Equipo ${i}" required>
                `;
                container.appendChild(teamDiv);
            }
            
            // Actualizar título
            document.getElementById('players-title').textContent = `INGRESE NOMBRES DE ${teamCount} EQUIPOS`;
            
            closeModal('team-modal');
            document.getElementById('main-screen').classList.add('hidden');
            document.getElementById('players-screen').classList.remove('hidden');
        }
        
        // Volver al menú principal
        function goBackToMain() {
            document.getElementById('players-screen').classList.add('hidden');
            document.getElementById('main-screen').classList.remove('hidden');
        }

        function goBackToMainFromTournament() {
            if (confirm('¿Volver al menú principal? Los cambios se guardarán automáticamente.')) {
                saveTournamentToStorage();
                document.getElementById('tournament-screen').classList.add('hidden');
                document.getElementById('main-screen').classList.remove('hidden');
                loadSavedTournaments();
            }
        }
        
        // Comenzar el torneo
        function startTournament() {
            // Obtener nombres de jugadores/equipos
            const nameInputs = document.querySelectorAll('.player-name');
            const names = Array.from(nameInputs).map(input => input.value.trim());
            
            // Validar que todos los nombres estén completos
            if (names.some(name => name === '')) {
                alert('Por favor, ingresa todos los nombres');
                return;
            }
            
            // Guardar en tournamentData
            if (tournamentData.mode === 'individual') {
                tournamentData.players = names.map(name => ({
                    name: name,
                    pg: 0, // Partidos ganados
                    pe: 0, // Partidos empatados
                    pp: 0, // Partidos perdidos
                    pf: 0, // Puntos a favor (goles marcados)
                    pc: 0, // Puntos en contra (goles recibidos)
                    diff: 0, // Diferencia (pf - pc)
                    points: 0 // Puntos totales
                }));
            } else {
                tournamentData.teams = names.map(name => ({
                    name: name,
                    pg: 0,
                    pe: 0,
                    pp: 0,
                    pf: 0,
                    pc: 0,
                    diff: 0,
                    points: 0
                }));
            }
            
            // Inicializar contador de partidos
            tournamentData.matchCounter = 0;
            
            // Generar todas las rondas
            generateRounds();
            
            // Actualizar interfaz
            document.getElementById('tournament-title').textContent = tournamentData.title;
            document.getElementById('players-screen').classList.add('hidden');
            document.getElementById('tournament-screen').classList.remove('hidden');
            showRound(1);
            updateStandings();
            updatePlayersTab();
            updateCycleInfo();
            
            // Guardar en localStorage
            saveTournamentToStorage();
        }

        // Generar ID único para partidos
        function generateMatchId() {
            tournamentData.matchCounter++;
            return `match-${tournamentData.matchCounter}`;
        }

        // Generar las rondas basadas en la información proporcionada
        function generateRounds() {
            if (tournamentData.mode === 'individual') {
                const playerNames = tournamentData.players.map(p => p.name);
                const playerCount = playerNames.length;
                
                tournamentData.rounds = [];
                
                // Generar rondas para diferentes cantidades de jugadores
                if (playerCount === 4) {
                    tournamentData.rounds = generateRoundRobin4Players(playerNames);
                } else if (playerCount === 5) {
                    tournamentData.rounds = generateRoundRobin5Players(playerNames);
                } else if (playerCount === 6) {
                    tournamentData.rounds = generateRoundRobin6Players(playerNames);
                } else if (playerCount === 7) {
                    tournamentData.rounds = generateRoundRobin7Players(playerNames);
                } else if (playerCount === 8) {
                    tournamentData.rounds = generateRoundRobin8Players(playerNames);
                } else if (playerCount === 9) {
                    tournamentData.rounds = generateRoundRobin9Players(playerNames);
                } else if (playerCount === 10) {
                    tournamentData.rounds = generateRoundRobin10Players(playerNames);
                }
                
                tournamentData.totalRounds = tournamentData.rounds.length;
            } else {
                // Lógica para torneo por equipos (simplificada)
                const teamNames = tournamentData.teams.map(t => t.name);
                tournamentData.rounds = [];
                tournamentData.totalRounds = teamNames.length - 1;
                
                for (let i = 0; i < tournamentData.totalRounds; i++) {
                    const matches = [];
                    const resting = [];
                    
                    // Calcular equipos en descanso
                    const restCount = teamNames.length % 2;
                    if (restCount > 0) {
                        resting.push(teamNames[teamNames.length - 1]);
                    }
                    
                    // Equipos que participan
                    const playingTeams = restCount > 0 ? teamNames.slice(0, teamNames.length - restCount) : teamNames;
                    
                    // Crear partidos
                    for (let j = 0; j < playingTeams.length; j += 2) {
                        matches.push({
                            id: generateMatchId(),
                            team1: playingTeams[j],
                            team2: playingTeams[j + 1],
                            score1: 0,
                            score2: 0,
                            played: false
                        });
                    }
                    
                    tournamentData.rounds.push({
                        matches: matches,
                        resting: resting
                    });
                    
                    // Rotar equipos para la siguiente ronda
                    teamNames.splice(1, 0, teamNames.pop());
                }
            }
        }

        // Funciones para generar rondas round-robin para diferentes cantidades de jugadores
        function generateRoundRobin4Players(playerNames) {
            return [
                {
                    matches: [
                        {
                            id: generateMatchId(),
                            team1: `${playerNames[0]} & ${playerNames[1]}`,
                            team2: `${playerNames[2]} & ${playerNames[3]}`,
                            players1: [playerNames[0], playerNames[1]],
                            players2: [playerNames[2], playerNames[3]],
                            score1: 0,
                            score2: 0,
                            played: false
                        }
                    ],
                    resting: []
                },
                {
                    matches: [
                        {
                            id: generateMatchId(),
                            team1: `${playerNames[0]} & ${playerNames[2]}`,
                            team2: `${playerNames[1]} & ${playerNames[3]}`,
                            players1: [playerNames[0], playerNames[2]],
                            players2: [playerNames[1], playerNames[3]],
                            score1: 0,
                            score2: 0,
                            played: false
                        }
                    ],
                    resting: []
                },
                {
                    matches: [
                        {
                            id: generateMatchId(),
                            team1: `${playerNames[0]} & ${playerNames[3]}`,
                            team2: `${playerNames[1]} & ${playerNames[2]}`,
                            players1: [playerNames[0], playerNames[3]],
                            players2: [playerNames[1], playerNames[2]],
                            score1: 0,
                            score2: 0,
                            played: false
                        }
                    ],
                    resting: []
                }
            ];
        }

        function generateRoundRobin5Players(playerNames) {
            return [
                {
                    matches: [
                        {
                            id: generateMatchId(),
                            team1: `${playerNames[0]} & ${playerNames[1]}`,
                            team2: `${playerNames[2]} & ${playerNames[3]}`,
                            players1: [playerNames[0], playerNames[1]],
                            players2: [playerNames[2], playerNames[3]],
                            score1: 0,
                            score2: 0,
                            played: false
                        }
                    ],
                    resting: [playerNames[4]]
                },
                {
                    matches: [
                        {
                            id: generateMatchId(),
                            team1: `${playerNames[0]} & ${playerNames[2]}`,
                            team2: `${playerNames[3]} & ${playerNames[4]}`,
                            players1: [playerNames[0], playerNames[2]],
                            players2: [playerNames[3], playerNames[4]],
                            score1: 0,
                            score2: 0,
                            played: false
                        }
                    ],
                    resting: [playerNames[1]]
                },
                {
                    matches: [
                        {
                            id: generateMatchId(),
                            team1: `${playerNames[0]} & ${playerNames[4]}`,
                            team2: `${playerNames[1]} & ${playerNames[2]}`,
                            players1: [playerNames[0], playerNames[4]],
                            players2: [playerNames[1], playerNames[2]],
                            score1: 0,
                            score2: 0,
                            played: false
                        }
                    ],
                    resting: [playerNames[3]]
                },
                {
                    matches: [
                        {
                            id: generateMatchId(),
                            team1: `${playerNames[1]} & ${playerNames[4]}`,
                            team2: `${playerNames[2]} & ${playerNames[3]}`,
                            players1: [playerNames[1], playerNames[4]],
                            players2: [playerNames[2], playerNames[3]],
                            score1: 0,
                            score2: 0,
                            played: false
                        }
                    ],
                    resting: [playerNames[0]]
                },
                {
                    matches: [
                        {
                            id: generateMatchId(),
                            team1: `${playerNames[0]} & ${playerNames[3]}`,
                            team2: `${playerNames[1]} & ${playerNames[4]}`,
                            players1: [playerNames[0], playerNames[3]],
                            players2: [playerNames[1], playerNames[4]],
                            score1: 0,
                            score2: 0,
                            played: false
                        }
                    ],
                    resting: [playerNames[2]]
                }
            ];
        }

        function generateRoundRobin6Players(playerNames) {
            return [
                // Ronda 1: (5,6) vs (2,1)
                {
                    matches: [
                        {
                            id: generateMatchId(),
                            team1: `${playerNames[4]} & ${playerNames[5]}`,
                            team2: `${playerNames[1]} & ${playerNames[0]}`,
                            players1: [playerNames[4], playerNames[5]],
                            players2: [playerNames[1], playerNames[0]],
                            score1: 0,
                            score2: 0,
                            played: false
                        }
                    ],
                    resting: [playerNames[2], playerNames[3]]
                },
                // Ronda 2: (4,2) vs (1,3)
                {
                    matches: [
                        {
                            id: generateMatchId(),
                            team1: `${playerNames[3]} & ${playerNames[1]}`,
                            team2: `${playerNames[0]} & ${playerNames[2]}`,
                            players1: [playerNames[3], playerNames[1]],
                            players2: [playerNames[0], playerNames[2]],
                            score1: 0,
                            score2: 0,
                            played: false
                        }
                    ],
                    resting: [playerNames[4], playerNames[5]]
                },
                // Ronda 3: (3,4) vs (5,2)
                {
                    matches: [
                        {
                            id: generateMatchId(),
                            team1: `${playerNames[2]} & ${playerNames[3]}`,
                            team2: `${playerNames[4]} & ${playerNames[1]}`,
                            players1: [playerNames[2], playerNames[3]],
                            players2: [playerNames[4], playerNames[1]],
                            score1: 0,
                            score2: 0,
                            played: false
                        }
                    ],
                    resting: [playerNames[0], playerNames[5]]
                },
                // Ronda 4: (2,3) vs (6,4)
                {
                    matches: [
                        {
                            id: generateMatchId(),
                            team1: `${playerNames[1]} & ${playerNames[2]}`,
                            team2: `${playerNames[5]} & ${playerNames[3]}`,
                            players1: [playerNames[1], playerNames[2]],
                            players2: [playerNames[5], playerNames[3]],
                            score1: 0,
                            score2: 0,
                            played: false
                        }
                    ],
                    resting: [playerNames[0], playerNames[4]]
                },
                // Ronda 5: (6,1) vs (4,5)
                {
                    matches: [
                        {
                            id: generateMatchId(),
                            team1: `${playerNames[5]} & ${playerNames[0]}`,
                            team2: `${playerNames[3]} & ${playerNames[4]}`,
                            players1: [playerNames[5], playerNames[0]],
                            players2: [playerNames[3], playerNames[4]],
                            score1: 0,
                            score2: 0,
                            played: false
                        }
                    ],
                    resting: [playerNames[1], playerNames[2]]
                },
                // Ronda 6: (1,5) vs (3,6)
                {
                    matches: [
                        {
                            id: generateMatchId(),
                            team1: `${playerNames[0]} & ${playerNames[4]}`,
                            team2: `${playerNames[2]} & ${playerNames[5]}`,
                            players1: [playerNames[0], playerNames[4]],
                            players2: [playerNames[2], playerNames[5]],
                            score1: 0,
                            score2: 0,
                            played: false
                        }
                    ],
                    resting: [playerNames[1], playerNames[3]]
                }
            ];
        }

        function generateRoundRobin7Players(playerNames) {
            // Implementación para 7 jugadores
            const rounds = [];
            for (let i = 0; i < 7; i++) {
                const matches = [];
                const resting = [];
                
                // Calcular jugadores en descanso (2 por ronda)
                resting.push(playerNames[i % 7]);
                resting.push(playerNames[(i + 1) % 7]);
                
                // Jugadores que participan
                const playingPlayers = playerNames.filter(p => !resting.includes(p));
                
                // Crear partidos
                matches.push({
                    id: generateMatchId(),
                    team1: `${playingPlayers[0]} & ${playingPlayers[1]}`,
                    team2: `${playingPlayers[2]} & ${playingPlayers[3]}`,
                    players1: [playingPlayers[0], playingPlayers[1]],
                    players2: [playingPlayers[2], playingPlayers[3]],
                    score1: 0,
                    score2: 0,
                    played: false
                });
                
                rounds.push({
                    matches: matches,
                    resting: resting
                });
            }
            return rounds;
        }

        function generateRoundRobin8Players(playerNames) {
            // Implementación para 8 jugadores
            const rounds = [];
            for (let i = 0; i < 7; i++) {
                const matches = [];
                const resting = [];
                
                // Calcular jugadores en descanso (ninguno para 8 jugadores)
                // Jugadores que participan
                const playingPlayers = [...playerNames];
                
                // Crear partidos (2 partidos por ronda)
                matches.push({
                    id: generateMatchId(),
                    team1: `${playingPlayers[0]} & ${playingPlayers[1]}`,
                    team2: `${playingPlayers[2]} & ${playingPlayers[3]}`,
                    players1: [playingPlayers[0], playingPlayers[1]],
                    players2: [playingPlayers[2], playingPlayers[3]],
                    score1: 0,
                    score2: 0,
                    played: false
                });
                
                matches.push({
                    id: generateMatchId(),
                    team1: `${playingPlayers[4]} & ${playingPlayers[5]}`,
                    team2: `${playingPlayers[6]} & ${playingPlayers[7]}`,
                    players1: [playingPlayers[4], playingPlayers[5]],
                    players2: [playingPlayers[6], playingPlayers[7]],
                    score1: 0,
                    score2: 0,
                    played: false
                });
                
                rounds.push({
                    matches: matches,
                    resting: resting
                });
                
                // Rotar jugadores para la siguiente ronda
                playerNames.push(playerNames.shift());
            }
            return rounds;
        }

        function generateRoundRobin9Players(playerNames) {
            // Implementación para 9 jugadores
            const rounds = [];
            for (let i = 0; i < 9; i++) {
                const matches = [];
                const resting = [];
                
                // Calcular jugadores en descanso (1 por ronda)
                resting.push(playerNames[i % 9]);
                
                // Jugadores que participan
                const playingPlayers = playerNames.filter(p => !resting.includes(p));
                
                // Crear partidos (2 partidos por ronda)
                matches.push({
                    id: generateMatchId(),
                    team1: `${playingPlayers[0]} & ${playingPlayers[1]}`,
                    team2: `${playingPlayers[2]} & ${playingPlayers[3]}`,
                    players1: [playingPlayers[0], playingPlayers[1]],
                    players2: [playingPlayers[2], playingPlayers[3]],
                    score1: 0,
                    score2: 0,
                    played: false
                });
                
                matches.push({
                    id: generateMatchId(),
                    team1: `${playingPlayers[4]} & ${playingPlayers[5]}`,
                    team2: `${playingPlayers[6]} & ${playingPlayers[7]}`,
                    players1: [playingPlayers[4], playingPlayers[5]],
                    players2: [playingPlayers[6], playingPlayers[7]],
                    score1: 0,
                    score2: 0,
                    played: false
                });
                
                rounds.push({
                    matches: matches,
                    resting: resting
                });
            }
            return rounds;
        }

        function generateRoundRobin10Players(playerNames) {
            // Implementación para 10 jugadores
            const rounds = [];
            for (let i = 0; i < 9; i++) {
                const matches = [];
                const resting = [];
                
                // Calcular jugadores en descanso (ninguno para 10 jugadores)
                // Jugadores que participan
                const playingPlayers = [...playerNames];
                
                // Crear partidos (2 partidos por ronda)
                matches.push({
                    id: generateMatchId(),
                    team1: `${playingPlayers[0]} & ${playingPlayers[1]}`,
                    team2: `${playingPlayers[2]} & ${playingPlayers[3]}`,
                    players1: [playingPlayers[0], playingPlayers[1]],
                    players2: [playingPlayers[2], playingPlayers[3]],
                    score1: 0,
                    score2: 0,
                    played: false
                });
                
                matches.push({
                    id: generateMatchId(),
                    team1: `${playingPlayers[4]} & ${playingPlayers[5]}`,
                    team2: `${playingPlayers[6]} & ${playingPlayers[7]}`,
                    players1: [playingPlayers[4], playingPlayers[5]],
                    players2: [playingPlayers[6], playingPlayers[7]],
                    score1: 0,
                    score2: 0,
                    played: false
                });
                
                matches.push({
                    id: generateMatchId(),
                    team1: `${playingPlayers[8]} & ${playingPlayers[9]}`,
                    team2: `${playingPlayers[0]} & ${playingPlayers[2]}`,
                    players1: [playingPlayers[8], playingPlayers[9]],
                    players2: [playingPlayers[0], playingPlayers[2]],
                    score1: 0,
                    score2: 0,
                    played: false
                });
                
                rounds.push({
                    matches: matches,
                    resting: resting
                });
                
                // Rotar jugadores para la siguiente ronda
                playerNames.push(playerNames.shift());
            }
            return rounds;
        }

        // Generar nuevas rondas para una nueva jornada
        function generateNewCycleRounds() {
            if (tournamentData.mode === 'individual') {
                const playerNames = tournamentData.players.map(p => p.name);
                const playerCount = playerNames.length;
                let newRounds = [];
                
                // Generar nuevas rondas para la nueva jornada
                if (playerCount === 4) {
                    newRounds = generateRoundRobin4Players(playerNames);
                } else if (playerCount === 5) {
                    newRounds = generateRoundRobin5Players(playerNames);
                } else if (playerCount === 6) {
                    newRounds = generateRoundRobin6Players(playerNames);
                } else if (playerCount === 7) {
                    newRounds = generateRoundRobin7Players(playerNames);
                } else if (playerCount === 8) {
                    newRounds = generateRoundRobin8Players(playerNames);
                } else if (playerCount === 9) {
                    newRounds = generateRoundRobin9Players(playerNames);
                } else if (playerCount === 10) {
                    newRounds = generateRoundRobin10Players(playerNames);
                }
                
                // Agregar las nuevas rondas a las existentes
                tournamentData.rounds = [...tournamentData.rounds, ...newRounds];
                tournamentData.totalRounds = tournamentData.rounds.length;
            } else {
                // Lógica similar para torneos por equipos
                const teamNames = tournamentData.teams.map(t => t.name);
                const newRounds = [];
                
                // Crear nuevas rondas usando el método round-robin
                for (let i = 0; i < teamNames.length - 1; i++) {
                    const matches = [];
                    const resting = [];
                    
                    // Calcular equipos en descanso
                    const restCount = teamNames.length % 2;
                    if (restCount > 0) {
                        resting.push(teamNames[teamNames.length - 1]);
                    }
                    
                    // Equipos que participan
                    const playingTeams = restCount > 0 ? teamNames.slice(0, teamNames.length - restCount) : teamNames;
                    
                    // Crear partidos
                    for (let j = 0; j < playingTeams.length; j += 2) {
                        matches.push({
                            id: generateMatchId(),
                            team1: playingTeams[j],
                            team2: playingTeams[j + 1],
                            score1: 0,
                            score2: 0,
                            played: false
                        });
                    }
                    
                    newRounds.push({
                        matches: matches,
                        resting: resting
                    });
                    
                    // Rotar equipos para la siguiente ronda
                    teamNames.splice(1, 0, teamNames.pop());
                }
                
                // Agregar las nuevas rondas a las existentes
                tournamentData.rounds = [...tournamentData.rounds, ...newRounds];
                tournamentData.totalRounds = tournamentData.rounds.length;
            }
        }

        // Actualizar navegación de rondas
        function updateRoundNav() {
            const roundNav = document.getElementById('round-nav');
            roundNav.innerHTML = '';
            
            for (let i = 1; i <= tournamentData.totalRounds; i++) {
                const roundBtn = document.createElement('div');
                roundBtn.className = `round-btn ${i === tournamentData.currentRound ? 'active' : ''}`;
                roundBtn.textContent = i;
                roundBtn.onclick = () => showRound(i);
                roundNav.appendChild(roundBtn);
            }
        }

        // Actualizar información del ciclo actual
        function updateCycleInfo() {
            document.getElementById('cycle-info').textContent = `Jornada ${tournamentData.currentCycle} de ${tournamentData.totalCycles}`;
        }

        // Mostrar una ronda específica
        function showRound(roundNumber) {
            tournamentData.currentRound = roundNumber;
            updateRoundNav();
            updateMatchesTab();
        }

        // Actualizar pestaña de partidos
        function updateMatchesTab() {
            const matchesContainer = document.getElementById('matches-container');
            const restingPlayersContainer = document.getElementById('resting-players-container');
            matchesContainer.innerHTML = '';
            restingPlayersContainer.innerHTML = '';
            
            const currentRound = tournamentData.rounds[tournamentData.currentRound - 1];
            
            if (!currentRound) return;
            
            // Mostrar partidos
            currentRound.matches.forEach((match, index) => {
                const matchCard = document.createElement('div');
                matchCard.className = 'match-card';
                
                // Determinar si hay un ganador para este partido
                if (match.score1 > match.score2) {
                    matchCard.classList.add('winner-1');
                } else if (match.score1 < match.score2) {
                    matchCard.classList.add('winner-2');
                } else if (match.score1 > 0 || match.score2 > 0) {
                    matchCard.classList.add('draw');
                }
                
                matchCard.innerHTML = `
                    <div class="winner-badge team1">${match.team1} gana</div>
                    <div class="winner-badge team2">${match.team2} gana</div>
                    <div class="match-header">
                        <div class="match-title">Partido ${index + 1}</div>
                        <div class="match-court">Pista ${index + 1}</div>
                    </div>
                    <div class="teams-container">
                        <div class="team">
                            <div class="team-name">${match.team1}</div>
                            ${tournamentData.mode === 'individual' ? 
                                `<div class="team-players">${match.players1 ? match.players1.join(' & ') : 'Jugadores'}</div>` : ''}
                            <div class="score-container">
                                <button class="score-btn" onclick="adjustScore('${match.id}', 'score1', -1)">-</button>
                                <input type="number" class="score-input" value="${match.score1}" min="0" max="99" 
                                    onchange="updateScore('${match.id}', 'score1', this.value)">
                                <button class="score-btn" onclick="adjustScore('${match.id}', 'score1', 1)">+</button>
                            </div>
                        </div>
                        <div class="vs">VS</div>
                        <div class="team">
                            <div class="team-name">${match.team2}</div>
                            ${tournamentData.mode === 'individual' ? 
                                `<div class="team-players">${match.players2 ? match.players2.join(' & ') : 'Jugadores'}</div>` : ''}
                            <div class="score-container">
                                <button class="score-btn" onclick="adjustScore('${match.id}', 'score2', -1)">-</button>
                                <input type="number" class="score-input" value="${match.score2}" min="0" max="99" 
                                    onchange="updateScore('${match.id}', 'score2', this.value)">
                                <button class="score-btn" onclick="adjustScore('${match.id}', 'score2', 1)">+</button>
                            </div>
                        </div>
                    </div>
                `;
                matchesContainer.appendChild(matchCard);
            });
            
            // Mostrar jugadores/equipos que descansan
            if (currentRound.resting && currentRound.resting.length > 0) {
                currentRound.resting.forEach(player => {
                    const playerElement = document.createElement('div');
                    playerElement.className = 'rest-player';
                    playerElement.textContent = player;
                    restingPlayersContainer.appendChild(playerElement);
                });
            }
        }

        // Ajustar puntuación con botones
        function adjustScore(matchId, scoreType, value) {
            for (let round of tournamentData.rounds) {
                const matchIndex = round.matches.findIndex(m => m.id === matchId);
                if (matchIndex !== -1) {
                    const currentValue = round.matches[matchIndex][scoreType];
                    const newValue = Math.max(0, currentValue + value);
                    
                    round.matches[matchIndex][scoreType] = newValue;
                    round.matches[matchIndex].played = newValue > 0 || round.matches[matchIndex][scoreType === 'score1' ? 'score2' : 'score1'] > 0;
                    
                    // Actualizar la interfaz
                    updateStandings();
                    updateMatchesTab();
                    saveTournamentToStorage();
                    break;
                }
            }
        }

        // Actualizar puntuación de un partido
        function updateScore(matchId, scoreType, value) {
            for (let round of tournamentData.rounds) {
                const matchIndex = round.matches.findIndex(m => m.id === matchId);
                if (matchIndex !== -1) {
                    round.matches[matchIndex][scoreType] = parseInt(value) || 0;
                    round.matches[matchIndex].played = round.matches[matchIndex].score1 > 0 || round.matches[matchIndex].score2 > 0;
                    updateStandings();
                    updateMatchesTab();
                    saveTournamentToStorage();
                    break;
                }
            }
        }

        // Actualizar tabla de clasificación
        function updateStandings() {
            // Resetear estadísticas
            if (tournamentData.mode === 'individual') {
                tournamentData.players.forEach(player => {
                    player.pg = 0;
                    player.pe = 0;
                    player.pp = 0;
                    player.pf = 0;
                    player.pc = 0;
                    player.diff = 0;
                    player.points = 0;
                });
            } else {
                tournamentData.teams.forEach(team => {
                    team.pg = 0;
                    team.pe = 0;
                    team.pp = 0;
                    team.pf = 0;
                    team.pc = 0;
                    team.diff = 0;
                    team.points = 0;
                });
            }

            // Calcular estadísticas basadas en todos los partidos jugados
            tournamentData.rounds.forEach(round => {
                round.matches.forEach(match => {
                    const score1 = match.score1;
                    const score2 = match.score2;
                    
                    // Solo procesar partidos que se hayan jugado (al menos un punto)
                    if (score1 === 0 && score2 === 0) return;
                    
                    if (tournamentData.mode === 'individual') {
                        // Actualizar estadísticas para cada jugador individualmente
                        const players1 = match.players1;
                        const players2 = match.players2;
                        
                        players1.forEach(playerName => {
                            const player = tournamentData.players.find(p => p.name === playerName);
                            if (player) {
                                player.pf += score1;
                                player.pc += score2;
                                player.diff = player.pf - player.pc;
                                
                                if (score1 > score2) {
                                    player.pg++;
                                    player.points += 3;
                                } else if (score1 < score2) {
                                    player.pp++;
                                } else {
                                    player.pe++;
                                    player.points += 1;
                                }
                            }
                        });
                        
                        players2.forEach(playerName => {
                            const player = tournamentData.players.find(p => p.name === playerName);
                            if (player) {
                                player.pf += score2;
                                player.pc += score1;
                                player.diff = player.pf - player.pc;
                                
                                if (score2 > score1) {
                                    player.pg++;
                                    player.points += 3;
                                } else if (score2 < score1) {
                                    player.pp++;
                                } else {
                                    player.pe++;
                                    player.points += 1;
                                }
                            }
                        });
                    } else {
                        // Modo por equipos
                        const team1 = tournamentData.teams.find(t => t.name === match.team1);
                        const team2 = tournamentData.teams.find(t => t.name === match.team2);
                        
                        if (team1 && team2) {
                            team1.pf += score1;
                            team1.pc += score2;
                            team2.pf += score2;
                            team2.pc += score1;
                            
                            team1.diff = team1.pf - team1.pc;
                            team2.diff = team2.pf - team2.pc;
                            
                            if (score1 > score2) {
                                team1.pg++;
                                team1.points += 3;
                                team2.pp++;
                            } else if (score1 < score2) {
                                team1.pp++;
                                team2.pg++;
                                team2.points += 3;
                            } else {
                                team1.pe++;
                                team2.pe++;
                                team1.points += 1;
                                team2.points += 1;
                            }
                        }
                    }
                });
            });
            
            // Actualizar tabla
            updateStandingsTable();
        }

        // Actualizar tabla de clasificación
        function updateStandingsTable() {
            const sortBy = document.querySelector('.filter-btn.active')?.dataset.sort || 'points';
            let participants;
            
            if (tournamentData.mode === 'individual') {
                participants = [...tournamentData.players];
            } else {
                participants = [...tournamentData.teams];
            }
                
            if (sortBy === 'points') {
                participants.sort((a, b) => {
                    if (b.points !== a.points) return b.points - a.points;
                    if (b.diff !== a.diff) return b.diff - a.diff;
                    return b.pf - a.pf;
                });
            } else if (sortBy === 'diff') {
                participants.sort((a, b) => {
                    if (b.diff !== a.diff) return b.diff - a.diff;
                    if (b.points !== a.points) return b.points - a.points;
                    return b.pf - a.pf;
                });
            } else if (sortBy === 'pg') {
                participants.sort((a, b) => {
                    if (b.pg !== a.pg) return b.pg - a.pg;
                    if (b.points !== a.points) return b.points - a.points;
                    return b.diff - a.diff;
                });
            }
            
            const tbody = document.getElementById('standings-body');
            tbody.innerHTML = '';
            
            participants.forEach((participant, index) => {
                const row = document.createElement('tr');
                
                let rowClass = '';
                if (index === 0) rowClass = 'pos-1';
                else if (index === 1) rowClass = 'pos-2';
                else if (index === 2) rowClass = 'pos-3';
                
                row.className = rowClass;
                row.innerHTML = `
                    <td>${index + 1}</td>
                    <td>${participant.name}</td>
                    <td>${participant.pg + participant.pe + participant.pp}</td>
                    <td>${participant.pg}</td>
                    <td>${participant.pe}</td>
                    <td>${participant.pp}</td>
                    <td>${participant.pf}</td>
                    <td>${participant.pc}</td>
                    <td>${participant.diff > 0 ? '+' : ''}${participant.diff}</td>
                    <td><strong>${participant.points}</strong></td>
                `;
                tbody.appendChild(row);
            });
        }

        // Actualizar pestaña de jugadores
        function updatePlayersTab() {
            const container = document.getElementById('players-container');
            container.innerHTML = '';
            
            let participants;
            
            if (tournamentData.mode === 'individual') {
                participants = [...tournamentData.players];
            } else {
                participants = [...tournamentData.teams];
            }
            
            // Ordenar por puntos
            const sortedParticipants = [...participants].sort((a, b) => b.points - a.points);
            
            sortedParticipants.forEach(participant => {
                const playerCard = document.createElement('div');
                playerCard.className = 'player-card';
                
                if (tournamentData.mode === 'individual') {
                    playerCard.innerHTML = `
                        <h3>${participant.name}</h3>
                        <p>${participant.pg} V - ${participant.pe} E - ${participant.pp} D</p>
                        <p>GF: <span class="stats-highlight">${participant.pf}</span> | GC: ${participant.pc} | Dif: ${participant.diff > 0 ? '+' : ''}${participant.diff}</p>
                        <p>Puntos: <strong>${participant.points}</strong></p>
                    `;
                } else {
                    playerCard.innerHTML = `
                        <h3>${participant.name}</h3>
                        <p>${participant.pg} V - ${participant.pe} E - ${participant.pp} D</p>
                        <p>GF: <span class="stats-highlight">${participant.pf}</span> | GC: ${participant.pc} | Dif: ${participant.diff > 0 ? '+' : ''}${participant.diff}</p>
                        <p>Puntos: <strong>${participant.points}</strong></p>
                    `;
                }
                container.appendChild(playerCard);
            });
        }

        // Avanzar a la siguiente ronda
        function nextRound() {
            if (tournamentData.currentRound < tournamentData.totalRounds) {
                showRound(tournamentData.currentRound + 1);
                saveTournamentToStorage();
            } else {
                alert('¡Has completado todas las rondas de esta jornada!');
            }
        }

        // Finalizar jornada
        function finishTournament() {
            alert('Jornada finalizada. Los puntos se mantendrán para la siguiente jornada.');
            saveTournamentToStorage();
        }

        // Continuar con nueva jornada - FUNCIÓN CORREGIDA
        function continueTournament() {
            // Incrementar el número de ciclo/jornada
            tournamentData.currentCycle++;
            
            // Guardar el estado actual de los participantes con sus estadísticas
            const currentParticipants = tournamentData.mode === 'individual' 
                ? JSON.parse(JSON.stringify(tournamentData.players)) 
                : JSON.parse(JSON.stringify(tournamentData.teams));
            
            // Generar nuevas rondas para la nueva jornada
            generateNewCycleRounds();
            
            // Restaurar las estadísticas de los participantes
            if (tournamentData.mode === 'individual') {
                tournamentData.players.forEach(player => {
                    const existingPlayer = currentParticipants.find(p => p.name === player.name);
                    if (existingPlayer) {
                        player.pg = existingPlayer.pg;
                        player.pe = existingPlayer.pe;
                        player.pp = existingPlayer.pp;
                        player.pf = existingPlayer.pf;
                        player.pc = existingPlayer.pc;
                        player.diff = existingPlayer.diff;
                        player.points = existingPlayer.points;
                    }
                });
            } else {
                tournamentData.teams.forEach(team => {
                    const existingTeam = currentParticipants.find(t => t.name === team.name);
                    if (existingTeam) {
                        team.pg = existingTeam.pg;
                        team.pe = existingTeam.pe;
                        team.pp = existingTeam.pp;
                        team.pf = existingTeam.pf;
                        team.pc = existingTeam.pc;
                        team.diff = existingTeam.diff;
                        team.points = existingTeam.points;
                    }
                });
            }
            
            // Reiniciar la ronda actual a la primera de la nueva jornada
            tournamentData.currentRound = 1;
            
            alert(`¡Nueva jornada ${tournamentData.currentCycle} iniciada! Los puntos se mantienen.`);
            updateCycleInfo();
            showRound(1);
            updateStandings();
            saveTournamentToStorage();
        }

        // Guardar torneo
        function saveTournament() {
            saveTournamentToStorage();
            alert('Progreso guardado correctamente');
        }
    </script>
</body>
</html>